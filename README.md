# passcoder

Изначальное требование: система защиты паролей при их хранении в записных книжках или блокнотах.

1. Поддерживаются три режима работы: режим регистрации пользователя, режим шифрования пароля, режим расшифрования пароля;

2. В режиме регистрации пользователя программа генерирует открытый и секретный ключи для шифрования паролей криптосистемой Рабина. Открытый ключ не подписан ЭЦП RSA на секретном ключе программы(валидация не работает). Необходимо ввести команду: "/register". Программа сгенерирует ключи в файлы с названиями user_private_key.txt, user_public_key.txt

TODO: изменить параметр длины с десятичной на двоичную.

Для генерации необходима факторная база в файле primes.txt.

3. Процедура смены ключа подписи программы не реализована.

4. Секретный ключ пользователя маскируется хэшом пароля, выбранного пользователем при генерации ключей. Используется алгоритм sha3_384(). В процессе генерации ключей программа попросит ввести пароль для защиты секретного ключа. 

5. Для режима шифрования необходимо ввести команду аля

"/encrypt -k user_public_key-protected.txt -p 124567"

Или ввести "/encrypt" и тогда программа сама спросит путь к файлу с открытым ключом и попросит ввести пароль, который пользователь хочет зашифровать. В результате выводится пароль, зашифрованный на открытом ключе пользователя криптосистемой Рабина: в том случае, если это позволяет длина пароля и длина ключа. Важно: на конкретных примерах на опыте было вычислено, для чисел p,q десятичной длины 7 шифрует пароли длины до 5 знаков включительно, для чисел десятичной длина 9 шифрует пароли длины до 7 знаков включительно.

6. Шифр-текст пароля выводится в кодировке base32, в которой удобно хранить его в записной книге или в блокноте.

7. Для расшифрования ранее зашифрованного пароля необходимо ввести команду

"/decrypt -k user_private_key-protected.txt -c G44TGMZXGYYTQNRWGE2TENZWGU3A===="

или "/decrypt" и программа запросит путь к файлу с секретным ключом и шифр-текст пароля в кодировке base32. Также программа попросит пароль для доступа к секретному ключу(для данного примера пароль bullbullbull). Если секретный ключ не соответствует шифртексту, выведется сообщение на экран.

Пароль защиты ключа для данных ключей: bullbullbull
